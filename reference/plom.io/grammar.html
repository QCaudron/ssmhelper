<!DOCTYPE html>
<!-- saved from url=(0069)https://web.archive.org/web/20130715142756/http://plom.io/cli/grammar -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<script type="text/javascript" src="./grammar_files/analytics.js"></script>
<link type="text/css" rel="stylesheet" href="./grammar_files/banner-styles.css">





    <title>PLOM.IO Social Modeling</title>

    <meta name="description" content="PLoM.io Public Library of Models">
    <meta name="keywords" content="PLoM model data inference social">
    <meta name="author" content="Sebastien Ballesteros">

    <link rel="stylesheet" media="screen" type="text/css" href="./grammar_files/jquery-ui-1.10.2.custom.min.css">
    <link rel="stylesheet" media="screen" type="text/css" href="./grammar_files/bootstrap.min.css">
    <link rel="stylesheet" media="screen" type="text/css" href="./grammar_files/prettify.css">
    <link rel="stylesheet" media="screen" type="text/css" href="./grammar_files/doc.css">
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
	<script src="/web/20130715142756/http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <script src="./grammar_files/jquery-1.9.1.min.js"></script><style type="text/css"></style>
    <script type="text/javascript" src="./grammar_files/set_active_menu.js"></script>
    <script src="./grammar_files/bootstrap.min.js"></script>
    <script type="text/javascript" src="./grammar_files/prettify.js"></script>
    <script type="text/x-mathjax-config;executed=true"> MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script>
    <script type="text/javascript" src="./grammar_files/MathJax.js"></script>


<link rel="stylesheet" media="screen" type="text/css" href="./grammar_files/white.css">
<style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style></head>

  <body onload="prettyPrint()"><div id="MathJax_Message" style="">Loading [MathJax]/extensions/MathZoom.js</div><div id="wm-ipp" lang="en" class="__wb_banner_div" style="display: block; position: relative; padding: 0px 5px; min-height: 70px; min-width: 800px;">


<div id="wm-ipp-inside" class="__wb_banner_div" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(/static/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:&#39;Lucida Grande&#39;,&#39;Arial&#39;,sans-serif!important;">
   

</div>
</div>
<!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script> if (window.archive_analytics) { window.archive_analytics.values['server_name']="wwwb-app18.us.archive.org";}; </script>

<script type="text/javascript" src="./grammar_files/disclaim-element.js"></script>
<script type="text/javascript" src="./grammar_files/graph-calc.js"></script>
<script type="text/javascript" src="./grammar_files/jquery.min.js"></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1420070399999;
var wbPrefix = "/web/";
var wbCurrentUrl = "http:\/\/plom.io\/cli\/grammar";

var curYear = -1;
var curMonth = -1;
var yearCount = 18;
var firstYear = 1996;
var imgWidth = 475;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "15";
var displayMonth = "Jul";
var displayYear = "2013";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>

<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->



  <div id="wrap">
    <div class="navbar navbar-fixed-top navbar-inverse">
      <div class="navbar-inner">
        <div class="container">
          
          <a class="brand" href="https://web.archive.org/web/20130715142756/http://plom.io/">PLOM.IO Public Library of Models</a>


          <ul class="nav pull-right">
              <li><a href="https://web.archive.org/web/20130715142756/http://plom.io/faq"><i class="icon-question-sign icon-white"></i></a></li>        
              <li><a href="https://web.archive.org/web/20130715142756/http://plom.io/api">API</a></li>        
              <li><a href="https://web.archive.org/web/20130715142756/http://plom.io/cli">CLI</a></li>        
            
            <li> <a href="https://web.archive.org/web/20130715142756/http://plom.io/login">Login</a> </li>
            <li> <a href="https://web.archive.org/web/20130715142756/http://plom.io/register">Register</a> </li>
            
          </ul>

          <form action="https://web.archive.org/web/20130715142756/http://plom.io/search" class="navbar-search" method="POST">
            <input class="search-query" type="text" name="q" id="plom-search" placeholder="Search the library for contexts or models">
            
            <button type="submit" class="btn hide">Search</button>
          </form>
          
        </div>
        <div id="topGradient" class="plom-gradient"></div>
      </div>
    </div>


    <div class="container">


</div>

<div id="submenu">
  <div class="container">
    <div class="row">
      <div class="span12">
        <ul class="breadcrumb">
          <li><a href="https://web.archive.org/web/20130715142756/http://plom.io/cli">CLI</a> <span class="divider">»</span></li>
          <li class="active"><a href="./grammar_files/grammar.html">Grammar</a> <span class="divider">»</span></li>
          <li><a href="https://web.archive.org/web/20130715142756/http://plom.io/cli/methods">Methods</a> <span class="divider">»</span></li>
          <li><a href="https://web.archive.org/web/20130715142756/http://plom.io/cli/hpc">High Performance Computing</a> <span class="divider">»</span></li>
          <li><a href="https://web.archive.org/web/20130715142756/http://plom.io/cli#workflow">Workflow</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>


<div class="container">
<div id="main">

<div class="page-header">
  <h1>A layered grammar <small>Making modeling social</small></h1>
</div>


<div class="row">

  <div class="span8">

    <p>
      How can we share models and make epidemiological
      modeling <strong>social</strong>?
    </p>

    <p> 
      The key here is the word <strong>layered</strong>. With PLOM.IO
      you create models <em>one layer at the time</em>. You start with
      the natural history of a disease and make
      a <strong>model</strong> for it. Then you apply
      this model to a set of cities, age classes, or risk groups
      (the <strong>context</strong> of the model).
    </p>

    <p>
      Changing the <strong>context</strong> on which the model is
      applied does not change the model. Similarly, changing the
      model doesn't affect the context. By keeping these two things
      separate, we open a world of possibilities: <strong>any model can
      be applied to any context and libraries of models can be
      created and shared</strong>.
    </p>

  </div>

</div>

<div class="page-header">
  <h1 id="process">The process <small>The natural history of the disease</small></h1>
</div>

<div class="row">

<img src="./grammar_files/sneeze_big.png" class="plom-img-center" alt="model illustration">

  <div class="span4">
    <h3>The SIR epidemiological model,</h3>

    <p>
      We start with the classical Susceptible-Infected-Recovered <a href="https://web.archive.org/web/20130715142756/http://en.wikipedia.org/wiki/Epidemic_model#The_SIR_Model">SIR model</a>.
    </p>

  </div>


  <div class="span4">
    <h3>with extra features, </h3>

    <p>
      We add birth and death processes, along with some noise on the
      transmission term.
    </p>

  </div>

  <div class="span4">
    <h3>written in JSON.</h3>

    <p>
      In PLOM.IO, your model is represented as
      a <a href="https://web.archive.org/web/20130715142756/http://www.json.org/">JSON</a> document. JSON is easy
      for humans to read and write, easy for machines to parse and
      generate, and lightweight. It is an ideal data-interchange
      language that gives us the ability to easily <strong>share</strong>
      models!
    </p>

    <p>
      Pretty much every programming language has a JSON encoder and
      decoder, which allows PLOM.IO to
      remain <strong>programming-language-agnostic</strong>. Within PLOM.IO,
      you get to develop your model with the tools you like.
    </p>

  </div>


</div>


<h3>What does it look like in JSON? See an example of process.json</h3>

<div class="row">

  <div class="span8">

<pre class="prettyprint">{
  "name": "SIR",
  "description": "SIR model with birth and death processes, and noise on the transmission term",

  "state": [
    {"id": "S", "comment": "Susceptible"},
    {"id": "I", "comment": "Infectious", "tag": ["infectious"]}
    {"id": "R", "comment": "Recovered", "tag": ["remainder"]}
  ],

  "parameter": [
    {"id": "r0",   "comment": "basic reproduction number"},
    {"id": "v",    "comment": "recovery rate"},
    {"id": "sto",  "comment": "noise intensity"},
    {"id": "mu_b", "comment": "birth rate"},
    {"id": "mu_d", "comment": "death rate"}
  ],

  "model": [
    {
      "comment":"birth",
      "from": "U", "to": "S",  "rate": "mu_b*N"
    },
    {
      "comment":"infection"      
      "from": "S", "to": "I",  "rate": "r0/N*v*I", "tag": ["transmission"]
    },
    {
      "comment":"recovery"
      "from": "I", "to": "R", "rate": "correct_rate(v)"
    },
    {
      "comment":"death"
      "from": "S", "to": "U",  "rate": "mu_d"
    },
    {
      "comment":"death"
      "from": "I", "to": "U",  "rate": "mu_d"
    }
  ],

 "white_noise": [
    {
      "reaction": [{"from":"S", "to": "I"}],
      "sd": "sto"
    }
  ]
}
</pre>


  </div>


  <div class="span4">

    <aside class="alert">
      All the <code>comment</code> properties are optional.
    </aside>
  
    <h4>Name and description</h4>
    <p>
      Start by defining the <code>name</code> and a <code>description</code> of your process.
      It is good practice to try to stick to a "SIR" like nomenclature.
    </p>

    <h4>State variables and parameters</h4>
    <ul>
    	<li> <code>state</code>:  state variables.</li>
        <li> <code>parameter</code>: process model parameters.</li>
    </ul>

    <h4>Process model definition</h4>
    <ul>
      <li>
        <code>model</code>: the process model is defined by
        a list of <em>reactions</em>, each reaction specifying:
        <ul>
          <li>transitions <code>from</code> one state <code>to</code> another, and</li>
          <li><code>rate</code>: the rate of transition.</li>
        </ul>
      </li>
    </ul>

    <h4>White noise</h4>

    <p>
      White noise can be added to a
      given <code>reaction</code>. The <code>sd</code> field
      determines the intensity of the noise. In this example, this
      intensity is the parameter <code>sto</code>.
    </p>
    <p>
      Correlated white noise can be incorporated by specifying a list
      of reactions in the <code>reaction</code> property instead of a
      single one.
    </p>
    

    <h4>Diffusions</h4>

    <p>
      To explore potential variations through time of a given parameter, it
      is possible to capture the dynamics of the parameter through a diffusion
      process. For each diffusion model, specify the corresponding
      <code>parameter</code>, <code>drift</code>
      and <code>volatility</code>. For instance, to let the
      parameter <code>r0</code> follow a random walk in the transformed space (i.e. $\text{d}\log r_0(t) = \sigma \text{d}B_t$), one would write:
    </p>

<pre class="prettyprint"> "diffusion": [
   {
     "parameter":"r0",
     "volatility": "sigma",
     "drift": 0.0
   }
 ]
</pre>

  </div>

</div>

<div class="row">
  <div class="span4">

    <h3>N, U ?</h3>

    <p>
      There are "states" involved in some reactions
      of the <code>model</code> that were not defined in the list
      of <code>state</code> variables (e.g. <code>N</code> and <code>U</code>).  These are predefined states:

      </p><ul>
        <li>
          <code>N</code> is the population size, and
        </li>
        <li>
          <code>U</code> is the Universe. The 'Universe' is where birth
          comes from and death goes to.
        </li>
      </ul>
    <p></p>

  </div>

  <div class="span4">
    <h3>rates?</h3>

    <p>
      Reactions starting with <code>U</code> have to contain
      rates <strong>multiplied</strong> by an associated number of
      individuals, as the population size is ambiguous in this case.
    </p>

    <p>
      For instance, in our example, note the difference between birth
      and death reactions: the death reactions only contain the death
      rate (<code>mu_d</code>), whereas the birth reactions contain
      the birth rate <em>mulitplied</em> by the population size
      (<code>mu_b*N</code>).
    </p>

  </div>


  <div class="span4">
    <h3>tag?</h3>

    Three things have to be tagged so that process models can be expanded to any contexts:
    <ol>
      <li>The infectious states (<code>"tag": ["infectious"]</code>).</li>
      <li>Reactions leading to transmission events (<code>"tag": ["transmission"]</code>).</li>
      <li>
        An optional remainder state (<code>"tag": ["remainder"]</code>). A remainder state is where
        things that we don't want to bookmark end up. In the case of 
        the SIR model presented here, we know the population size at any time is (<code>N</code>), therefore, we do not need to keep track of the
        recovered individuals (S + I + R = N, so R = N - S - I).
      </li>
    </ol>

  </div>

</div>

<div class="row">

  <div class="span8">
    <h3>Special functions to modify parameters</h3>

    <ul>
      <li>
        School term forcing function: <code>terms_forcing(amplitude)</code>
<pre class="prettyprint">  if (holiday) { 
      return amplitude/(1.0+amplitude*(1.0-prop_school));
  } else { //schools are in
      return 1.0/(1.0+amplitude*(1.0-prop_school));
  }
</pre>

<aside>
  where <em>prop_school</em> is the proportion of a year taken up by
  school and <em>holiday</em> is a boolean indicating if the time
  falls during an holiday season. Both <em>prop_school</em>
  and <em>holiday</em> come from metadata provided by the context
  (see <a href="https://web.archive.org/web/20130715142756/http://plom.io/cli/grammar#context">context.json</a>).
</aside>

      </li>

      <li><a href="https://web.archive.org/web/20130715142756/http://en.wikipedia.org/wiki/Heaviside_step_function">Heaviside step function</a> <code>heaviside(x)</code></li>
      
      <li><a href="https://web.archive.org/web/20130715142756/http://en.wikipedia.org/wiki/Ramp_function">Ramp function</a> <code>ramp(x)</code></li>

      <li>Sine function <code>sin()</code></li>
      <li>Cosine function <code>cos()</code></li>
      <li>Tangent function <code>tan()</code></li>
      <li>
        Correct rate <code>correct_rate(rate)</code>
<pre class="prettyprint">  return -log(1.0-rate*dt)/dt;
</pre>
<code>correct_rate</code> can be used to correct the effect of discretization when a duration (1/rate) is close to, or smaller than, the time discretization step <em>dt</em>.
      </li>
    </ul>

    <div class="alert alert-info">
      Need additional special functions? <a href="https://web.archive.org/web/20130715142756/https://github.com/plom-io/plom-pipe/issues/new">Open an issue</a> or send us a
      pull request on <a href="https://web.archive.org/web/20130715142756/https://github.com/plom-io/plom-pipe">github</a>.
    </div>
  </div>


  <div class="span4">
    <h3>Constants and symbols</h3>

    <ul>
      <li><code>t</code>: the time</li>
    </ul>

    <ul>
      <li>
        All the standard BSD mathematical constants as defined
        in <a href="https://web.archive.org/web/20130715142756/http://www.gnu.org/software/gsl/manual/html_node/Mathematical-Constants.html">GSL</a>
        as well
        as <a href="https://web.archive.org/web/20130715142756/http://www.gnu.org/software/gsl/manual/html_node/Physical-Constants.html">GSL
          physical constants</a> are directly available. <br> For instance, <code>M_PI</code> defines the
        number pi.
      </li>
      <li>
        <code>ONE_YEAR</code>: the duration of one year. For instance,
        sinusoidal forcing can be implemented with:
<pre class="prettyprint">(1.0 +e*sin(2.0*M_PI*(t/ONE_YEAR + d)))
</pre>
where <em>e</em> is the amplitude of the forcing and <em>d</em> is a dephasing parameter.
      </li>
    </ul>

  </div>



</div>



<div class="row">
  <div class="span12">
    <h3>Build models faster: program your model definition in any language</h3>

    <p>
      Remember that you can
      actually <em>program</em> your model definition
      using <strong>your favorite programming language</strong>. Just
      export the final object as JSON and you can use it with PLOM.IO. For instance, let's assume that we have a process
      model <code>p</code> missing death reactions. Let's automate the repetitive task of adding all of the death reactions. 
    </p>


    <div class="accordion" id="examples-prog">
      <div class="accordion-group">
        <div class="accordion-heading">
          <a class="accordion-toggle" data-toggle="collapse" data-parent="#examples-prog" href="https://web.archive.org/web/20130715142756/http://plom.io/cli/grammar#collapseJs">
            Javascript (Node.js)
          </a>
        </div>
        <div id="collapseJs" class="accordion-body collapse">
          <div class="accordion-inner">

<pre class="prettyprint">var fs = require('fs');

//add death reactions
p.state.forEach(function(x){
  p.model.push({from: x.id, to: 'U', rate: 'mu_d', comment:'death'});
});

//write the json file
fs.writeFileSync('process.json', JSON.stringify(p));
</pre>
          </div>
        </div>
      </div>

      <div class="accordion-group">
        <div class="accordion-heading">
          <a class="accordion-toggle" data-toggle="collapse" data-parent="#examples-prog" href="https://web.archive.org/web/20130715142756/http://plom.io/cli/grammar#collapsePy">
            Python
          </a>
        </div>
        <div id="collapsePy" class="accordion-body collapse">
          <div class="accordion-inner">

<pre class="prettyprint">import json

#add death reactions
for x in p['state']:
    p['model'].append({'from': x['id'], 'to': 'U', 'rate': 'mu_d', 'comment': 'death'})

#write the json file
json.dump(p, open('process.json', 'w'))
</pre>

          </div>
        </div>
      </div>


      <div class="accordion-group">
        <div class="accordion-heading">
          <a class="accordion-toggle" data-toggle="collapse" data-parent="#examples-prog" href="https://web.archive.org/web/20130715142756/http://plom.io/cli/grammar#collapseR">
            R
          </a>
        </div>
        <div id="collapseR" class="accordion-body collapse">
          <div class="accordion-inner">

<pre class="prettyprint">require('RJSONIO')

##add death reactions
for(x in p$state){
    p$model &lt;- c(p$model, list(list('from'=x$id, 'to'='U', 'rate'='mu_d', 'comment'='death')))
}

##write the json file
write(toJSON(p, collapse=''), file="process.json")
</pre>

          </div>
        </div>
      </div>


    </div>


  </div>
</div>


<div class="page-header">
  <h1 id="context">The context <small>Geography, structure, and data</small></h1>
</div>

<div class="row">

  <img src="./grammar_files/cities_small.png" class="plom-img-center" alt="context illustration">

  
  <div class="span4">
    <h3>A complex reality</h3>
    <p>
      With the emergence of social networks and global travel
      networks, we now have to deal with <strong>multiple time
      series</strong> coming from various populations (e.g. two
      different countries) and data streams (e.g. from google insights
      and the CDC). PLOM.IO gives you the
      proper <strong>semantics</strong> to encode arbitrarily complex
      contexts.
    </p>
  </div>

  <div class="span8">
    <h3>An example with the CDC and google</h3>

    <p>
      Consider that an epidemic takes place in 2 cities
      (named <em>city1</em> and <em>city2</em>) and that Google and
      the CDC collected <em>weekly</em> observations of the
      epidemiological process through a total of 4 time series.
    </p>

  </div>
</div>


<div class="row">

  <div class="span4">
    <h3>Observation Data</h3>

    <ul>
      <li>
        4 time series with <em>weekly</em> values:
        <ul>
          <li>
            <strong>Aggregated incidence</strong> observed in the 2 cities by the CDC
            reported when the individuals recover.
          </li>
          <li>
            <strong>Prevalence</strong> observed in city1 by the CDC.
          </li>
          <li>
            <strong>Incidence</strong> observed in city2 by the CDC, reported when the
            individuals are first infected.
          </li>
          <li>
            <strong>Aggregated incidence</strong> observed in the 2
            cities, as reported by the number of searches for the disease
            symptom terms collected by Google.
          </li>
        </ul>
      </li>

      <li>
        Data on surveillance systems for each data provider:
        <ul>
          <li>Proportion of the population under surveillance for each
            time series</li>
        </ul>
      </li>
    </ul>

  </div>

  <div class="span4">
    <h3>Population data</h3>

    <ul>  
      <li>Population sizes</li>
      <li>Birth rates</li>
      <li>Death rates</li>
    </ul>

  </div>

  <div class="span4">
    <h3>Structure</h3>

    <p>
      Assume that we also know that these 2 cities contain populations whose
      contact patterns are not age-dependent, so we can
      neglect <strong>age</strong> structure (i.e., we
      consider <em>all</em> the age classes together).
    </p>

  </div>

</div>

<h3>context.json</h3>

<div class="row">

  <div class="span8">

<pre class="prettyprint">{
  "name": "Planet Earth",

  "description": "an explicit description",
 
  "disease": ["measles"],
 
  "population": [
    {
      "id": "city1__all",
      "comment": "city 1, all age classes"
      "lat": 40.6549555134,
      "lng": -73.962053111 
    },
    {
      "id": "city2__all",
      "comment": "city 2, all age classes"
      "lat": 41.6249555134,
      "lng": -71.362053110
    }
  ],
 
  "time_series": [
    {
      "id": "all__CDC__inc",
      "population_id": ["city1__all", "city2__all"]
    },
    {
      "id": "all__google__inc",
      "population_id": ["city1__all", "city2__all"]
    },
    {
      "id": "city2__CDC__inc",
      "population_id": ["city2__all"]
    },
    {
      "id": "city1__CDC__prev",
      "population_id": ["city1__all"]
    }
  ], 

  "data": {
    "source": {
      "all__CDC__inc": {
         "t0": "2012-07-26"
         "value": [ ["2012-08-02", 6], ["2012-08-09", 12], ["2012-08-16", null] ],         
       },
       "all__google__inc": {
         "t0": "2012-07-26"
         "value": [ ["2012-08-02", 3], ["2012-08-09", 2], ["2012-08-16", null] ],
       },
       "city2__CDC__inc": {
         "t0": "2012-07-26"
         "value": [ ["2012-08-02", 1], ["2012-08-09", 42], ["2012-08-16", 4] ],
       },
       "city1__CDC__prev": {
         "t0": "2012-07-26"
         "value": [ ["2012-08-02", 12], ["2012-08-09", 68], ["2012-08-16", 14] ],
       }
     }
   },

  "metadata": [
    {
      "id": "N",
      "comment": "population size",
      "source": {
        "city1__all": {
          "value": [ ["2012-07-26", 1000000], ["2012-08-02", 1000000], ... ],
         },
        "city1__all": {
          "value": [ ["2012-07-26", 1002400], ["2012-08-02", 902400], ... ],
         }
      }
    },
    {
      "id": "prop",
      "comment": "proportion of the population under surveillance"
      "source": {
        "all__CDC__inc": {
          "value": [ ["2012-07-26", 1], ["2012-08-02", 1], ... ],
         },
        "all__google__inc": {
          "value": [ ["2012-07-26", 1], ["2012-08-02", 1], ... ],
         },
        "city2__CDC__inc": {
          "value": [ ["2012-07-26", 1], ["2012-08-02", 1], ... ],
         },
        "city1__CDC__prev": {
          "value": [ ["2012-07-26", 1], ["2012-08-02", 1], ... ],
         },
      }
    },
    {
      "id": "mu_b",
      "unit": "W",
      "comment": "birth rates"
      "source": {
        "city1__all": {
          "value": [ ["2012-07-26", 0.00027], ["2012-08-02", 0.00027], ... ],
         },
        "city1__all": {
          "value": [ ["2012-07-26", 0.00027], ["2012-08-02", 0.00027], ... ],
         }
      }
    },
    {
      "id": "mu_d",
      "unit": "W",
      "comment": "death rates"
      "source": {
        "city1__all": {
          "value": [ ["2012-07-26", 0.00027], ["2012-08-02", 0.00027], ... ],
         },
        "city1__all": {
          "value": [ ["2012-07-26", 0.00027], ["2012-08-02", 0.00027], ... ],
         }
      }
    }
  ]
}
</pre>

  </div>

  <div class="span4">

      <h4>Context name and description</h4>

      <ul>
        <li><code>name</code> an explicit name for the location, <em>e.g</em> "Princeton, NJ, USA" or "France".</li>
        <li><code>description</code> A description of the context</li>
      </ul>

    <h4>Diseases</h4>
    <ul>
      <li>
        <code>disease</code> A list of diseases involved, including strains of a single agent.
      </li>
    </ul>      

    <h4>Populations</h4>

    <ul>
      <li>
        <code>population</code> A list of populations (cities, age
        classes, ...) identified in the model.
        <ul>
          <li>
            <code>id</code> A unique id for the population named
            with the convention: <code>cityName<strong>__</strong>ageClassName</code>
          </li>
          <li>
            <code>lat</code> The latitude
          </li>
          <li>
            <code>lng</code> The longitude
          </li>
        </ul>
      </li>
    </ul>

    <h4>Data aggregation level</h4>
    <ul>
      <li>
        <code>time_series</code> The observed time series, for each include:
        <ul>
          <li><code>id</code> The unique id for the time series named with the convention:
            <code>timeSeriesName<strong>__</strong>dataStream<strong>__</strong>type</code>
            where type is incidence (<code>inc</code>) or prevalence
            (<code>prev</code>)
          </li>
          <li>
            <code>population_id</code> A list of population <code>id</code> detailing
            the population(s) observed by the time series
          </li>
        </ul>
      </li>
    </ul>


    <h4>Data / Metadata</h4>

    <ul>
      <li>
        <code>data</code> A list of datasets for the observation data
        (i.e related to <code>time_series</code>)
      </li>
      <li>
        <code>metada</code> A list of datasets for the population data
        (i.e related to <code>population</code>)
      </li>
    </ul>

    Each element of <code>data</code> or <code>metadata</code> contains:
    <ul>
      <li>
        <code>id</code> A unique id defining the data / metadta
      </li>
      <li>
        <code>source</code> 
        A JSON object containing:
        <ul>
          <li>
            Keys made of the <code>id</code>
            of <code>population</code> (for metadata) or <code>time
              series</code> (for data).
          </li>
          <li>value:
            <ul>
              <li>
                <code>t0</code> (only in case of data). Indicate the time (in
                the <a href="https://web.archive.org/web/20130715142756/http://www.w3.org/TR/NOTE-datetime">ISO
                  8601</a> format <code>"YYYY-MM-DD"</code>) when we
                should start to simulate the system before
                encountering the first data point. This is especialy
                important for incidence data.
              </li>
              <li><code>value</code>A list of couples of dates and numerical values
                <ul>
                  <li>
                    date in the <a href="https://web.archive.org/web/20130715142756/http://www.w3.org/TR/NOTE-datetime">ISO
                      8601</a> format (<code>"YYYY-MM-DD"</code>).
                  </li>             
                  <li>
                    Rates (e.g birth and death rates) have to be
                    expressed <em>per capita</em> and the unit has to be
                    specified with the property <code>unit</code> taking the
                    following values:
                    <ul>
                      <li><code>D</code>: days</li>
                      <li><code>W</code>: weeks</li>
                      <li><code>M</code>: months (taken to be 365.0/12.0 days)</li>
                      <li><code>Y</code>: years</li>
                    </ul>
                  </li>
                  <li>
                    For user convenience, rates can be parametrized as duration
                    (i.e. providing values for 1/rate instead of rate) by setting
                    the property <code>type</code> to the
                    value <em>'rate_as_duration'</em>
                  </li>
                  <li>
                    Missing values are encoded as <code>null</code>.
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>


    <div class="alert alert-info">
      <strong><a href="https://web.archive.org/web/20130715142756/http://en.wikipedia.org/wiki/Comma-separated_values">CSV</a> inputs</strong>
      
      <p>
        Alternatively, instead of a native JSON objects,
        the <code>source</code> property can point to
        a <a href="https://web.archive.org/web/20130715142756/http://en.wikipedia.org/wiki/Comma-separated_values">CSV</a>
        file.
      </p>

    <pre class="prettyprint">  "data": {      
    "source": "data/data.csv",
    "t0": "2012-07-26"
  },

  "metadata": [
    {
      "id": "N",
      "source": "data/N.csv",      
    },
    {
      "id": "prop",
      "source": "data/prop.csv",
    },
    {
      "id": "mu_b",
      "source": "data/mu_b.csv",
      "unit": "W",
    },
    {
      "id": "mu_d",
      "source": "data/mu_d.csv",
      "unit": "W",
    }
  ]
</pre>

    The CSV files take the following form:

    <pre class="prettyprint">"date", "city1__all", "city2__all"
"2012-08-02", 1020021, 1010034
"2012-08-09", 1020023, 1010036
"2012-08-16", 1020069, null
 ...
</pre>

    </div>

    <h4>School holidays</h4>

    When the metadata contains data on school holidays, <strong>daily</strong> values
    have to be provided with:
    <ul>
      <li>0 if school is in session</li>
      <li>1 if school is out of session (holidays)</li>
    </ul>

  </div>

</div>

<div class="row">

  <div class="span8">
    <h3>Forcing</h3>

    <p>
      Data whose <code>id</code> are equal
      to <code>parameter</code> <code>id</code>
      of <a href="https://web.archive.org/web/20130715142756/http://plom.io/cli/grammar#process">process.json</a> will be used
      to <strong>force</strong> the model. In our example, we use
      demographic data to inform the values of the birth rate, death
      rate, and population sizes (<code>mu_b</code>, <code>mu_d</code>
      and <code>N</code>).
    </p>
  </div>

</div>


<div class="row">
  <div class="span12">

    <h3>Including structure (spatial, age, multi-host and multi-vector)</h3>

    <div class="alert alert-danger">
      These features are under active development and have not been
      released yet. Join us
      on <a href="https://web.archive.org/web/20130715142756/https://github.com/plom-io/plom-pipe">github</a> to get
      involved.
    </div>

  </div>
</div>

<div class="page-header">
  <h1 id="link">The link <small>Connecting the context and the process with an observation model</small></h1>
</div>


<div class="row">
  <img src="./grammar_files/observation_small.png" class="plom-img-center" alt="link illustration">
</div>

<h3>link.json</h3>

<div class="row">

  <div class="span8">

<pre class="prettyprint">{
  "name": "oBinomial",

  "description": "an explicit description",

  "observed": [
    {
      "id": "prev",
      "comment":"prevalence",
      "definition": ["I"],
      "time_series_id": ["city1__CDC__prev"],
      "observation_id": "common"
    },
    {
      "id": "inc_out",
      "comment":"incidence (including death) measured at recovery time",
      "definition": [{"from":"I", "to":"R"}, {"from":"I", "to":"U"}],
      "time_series_id": ["all__CDC__inc", "all__google__inc"],
      "observation_id": "common"
    },
    {
      "id": "inc_in",
      "comment":"incidence measured at infection time",
      "definition": [{"from":"S", "to":"I"}],
      "time_series_id": ["city2__CDC__inc"],
      "observation_id": "common"
    }
  ],

  "observation": [
    {
      "id": "common", 
      "parameter": [
        {"id": "rep",  "comment": "reporting rate"},
        {"id": "phi",  "comment": "over-dispertion"},
        {"id": "prop", "comment": "proportion under surveillance"}
      ],
      "model": {
        "distribution": "discretized_normal",
        "mean": "rep*prop*x",
        "var": "rep*(1.0-rep)*prop*x + (rep*phi*prop*x)**2"
      }
    }
  ]
}
</pre>

  </div>


  <div class="span4">
    <h4>Link name and description</h4>
    <ul>
      <li><code>name</code> A name characterizing the observation model.</li>
      <li><code>description</code> A description of the observation model.</li>
    </ul>

    <h4>Observed Variables <code>observed</code></h4>

    <ul>
      <li>
        Either:
        <ul>
          <li><strong>Incidence</strong> (number of new cases during some time period)</li>
          <li><strong>Prevalence</strong> (number of cases)</li>
        </ul>
      </li>

      <li>Each observed quantity has an:      
        <ul>  
          <li><code>id</code> A unique id</li>
          
          <li><code>definition</code> A list of definitions of the
            observed variables. The list element will
            be <em>summed-up</em>.</li>
          <li><code>time_series_id</code> A <strong>list</strong> of times series being observed</li>
          <li><code>observation_id</code> <code>id</code> of the
            <strong>observation model</strong> used to observe this time-series.</li>
        </ul>
      </li>
    </ul>

    <h4>Observation Model <code>observation</code></h4>
    
    <ul>
      <li>A list of observation models each containing

        <ul>
          <li><code>id</code> the <code>id</code> refered by the
            times-series <code>model_id</code> property.
          </li>

          <li>
            <code>parameter</code> The parameter of the observation
            model. Here again, parameters whose <code>id</code> are
            present in the property <code>data</code> of
            the <em>context</em> will be <strong>forced</strong>.
          </li>

          <li>
            <code>model</code> the observation model specification.
            
            Here, we specify an over-dispersed binomial distribution
            defined as a discretized normal random variable with:
            <ul>
              <li>mean = rep2 * rep1 * x</li>
              <li>variance = rep2 * (1.0-rep2) * rep1 * x + (rep2 * phi * rep1 * x) * * 2</li>
            </ul>

            <code>x</code> is used to <strong>refer</strong>
            to an observed variable.
          </li>
        </ul>
      </li>
    </ul>

    <div class="alert alert-info">
      Need another distribution for your observation model? <a href="https://web.archive.org/web/20130715142756/https://github.com/plom-io/plom-pipe/issues/new">Open an issue</a> or send us a
      pull request on <a href="https://web.archive.org/web/20130715142756/https://github.com/plom-io/plom-pipe">github</a>.
    </div>

  </div>
  
</div>





<div class="page-header">
  <h1 id="theta">The parameters <small>priors, posteriors, and values</small></h1>
</div>


<div class="row">

  <img src="./grammar_files/theta_large.png" class="plom-img-center" alt="theta" height="120" width="120">

</div>

<h4>theta.json</h4>

<div class="row">

  <div class="span8">


<pre class="prettyprint">{
  "description": "an explicit description",
  
  "parameter": {
    "S": {
      "transformation": "logit",
      "distribution": "uniform",
      "min":0.01, "max": 0.1,
      "guess": 0.07,
      "sd_transf": 0.0
    },
    "I": {
      "transformation":"logit",
      "distribution": "uniform",
      "min": 7e-7, "max": 1e-3,
      "guess": 1e-05,
      "sd_transf": 3e-6
    },
    
    "r0": {
      "transformation": "log",
      "distribution": "uniform",
      "min": 10.0, "max": 30.0,
      "guess": 20.0,
      "sd_transf": 0.02
    },
    "v": {
      "transformation": "log", "unit": "D", "type": "rate_as_duration",
      "distribution": "uniform",
      "min": 5, "max": 20,
      "guess": 11,
      "sd_transf": 0.5
    },

    "sto": {
      "transformation": "log",
      "distribution": "uniform",
      "min": 0.05, "max": 0.2, 
      "guess": 0.1,
      "sd_transf": 0.0
    },
    
    "rep": {
      "transformation": "logit",
      "distribution": "uniform",
      "min": 0.2, "max": 0.9, 
      "guess":0.6, 
      "sd_transf": 0.0
    },
    "phi": {
      "transformation":"log",
      "distribution": "uniform",
      "min": 0.1, "max": 0.3,
      "guess": 0.1,
      "sd_transf": 0.02
    }
}
</pre>

  </div>


  <div class="span4">
    <h4>Theta description</h4>
    <ul>
      <li><code>description</code> A description of theta.</li>
    </ul>

    <h4>Parameter transformations</h4>  

    <ul>
      <li><code>transformation</code>: 

        Some parameters have to stay <strong>positive</strong>
        or <strong>bounded</strong>.  Specifying a transformation
        function is an easy way to ensure these constraints.
        Supported transformation are:

        <ul>
          <li><code>log</code> $x\mapsto\log(x)$</li>
          <li><code>logit</code> $x\mapsto\log(\frac{x}{1-x})$</li>
          <li><code>logit_ab</code> $x\mapsto\log(\frac{x-min}{max-x})$</li>
          <li><code>identity</code> $x\mapsto x$</li>
        </ul>

        The <code>transformation</code> property can also be used to
        perform inference on a non linear <strong>scale</strong>.
        Supported scales are:


        <ul>
          <li><code>scale_pow10</code> $10^x$</li>
          <li>
            <code>scale_pow10_neg</code> $10^{-x}$ with $x$ positive
            due to a log transformation
          </li>
          <li>
            <code>scale_pow10_bounded</code> $10^x$ with $x$
            constrainted between <code>min</code>
            and <code>max</code> with a logit_ab transformation.
          </li>
        </ul>


        <div class="alert alert-info">
          Need other transformations or scales ? <a href="https://web.archive.org/web/20130715142756/https://github.com/plom-io/plom-pipe/issues/new">Open an issue</a> or send us a
          pull request on <a href="https://web.archive.org/web/20130715142756/https://github.com/plom-io/plom-pipe">github</a>.
        </div>
      </li>

      <li>
        <code>unit</code>, <code>type</code>: if a parameter is a
        rate, its unit has to be specified using
        the <code>unit</code> property whose value can be:
        <ul>
          <li><code>D</code>: days</li>
          <li><code>W</code>: weeks</li>
          <li><code>M</code>: months (taken to be 365.0/12.0 days)</li>
          <li><code>Y</code>: years</li>
        </ul>
      </li>

      <li>
        For user convenience, rates can be parametrized as duration
        (i.e. providing values for 1/rate instead of rate) by
        setting the property <code>type</code> to the
        value <em>'rate_as_duration'</em>. In our case, <em>v</em>
        is the recovery rate, but we decided to parametrize it as a
        duration with a guess value of 11 days.
      </li>
    </ul>

    <h4>Prior <code>distribution</code></h4>

    Possible values are:
    <ul>
      <li>uniform</li>
      <li>normal</li>
    </ul>

    <div class="alert alert-info">
      Need other priors distribution ? <a href="https://web.archive.org/web/20130715142756/https://github.com/plom-io/plom-pipe/issues/new">Open an issue</a> or send us a
      pull request on <a href="https://web.archive.org/web/20130715142756/https://github.com/plom-io/plom-pipe">github</a>.
    </div>


    <h4>Follow</h4>

    <p>
      The <code>follow</code> property can be used so that a parameter
      is not infered but follow the value of another parameter specified as
      value (e.g <code>"I_1": {"follow": "I_0"}</code>).      
    </p>

    <h4>Parameter values</h4>

    <p>
      <code>min</code>, <code>max</code>,<code>guess</code>,<code>sd_transf</code>
      specify the values of the parameters
    </p>

  </div>

</div>



<div class="row">


  <div class="span4">
    <h3>Respecting constraint on the initial conditions</h3>

    <p>
      In case a model do not contain a <code>remainder</code> state
      but where the sum of the state variables has to
      sum <strong>exactly</strong> to the population size at t0, one
      initial condition <strong>has to be omitted</strong> from
      theta.json. For instance, for an SIR model without remainder,
      only <code>S</code> and <code>I</code> (and not <code>R</code>)
      will be specified in theta.json.
    </p>

  </div>


  <div class="span4">
    <h3>What do min, max mean for different prior distributions?</h3>

    <p>
      The semantic of <code>min</code>, <code>max</code> will vary
      depending on the prior being used. For instance, under a uniform prior
      <code>min</code> and <code>max</code> will
      be used to specify the boundaries of the prior whereas under a normal prior
      they are used to determine the 2.5% and 97.5% quantiles
      of the prior density.
    </p>

  </div>

  <div class="span4">
    <h3>What is sd_transf?</h3>

    <p>
      When parameters have to be mutated, the mutation occurs with a
      standard deviation of <code>sd_transf</code> in
      the <em>transformed</em> scale.  Setting <code>sd_transf</code>
      to 0 will fix the parameter to its guess value and ensure that
      it is <strong>not</strong> inferred.

    </p>

  </div>

</div>




<div class="row">

  <div class="span6">
    <h3>(Un)grouping parameters</h3>

    <p>
      By default, parameters are assumed to be
      <strong>identical</strong> across <em>populations</em>
      or <em>time series</em>.
    </p>

    <p>
      You can change this behavior by attaching
      a <code>partition_id</code> to your parameters.
      We provide 4 built-in partitions that can be specified:
      </p><ol>
        <li>
          <code>variable_population</code> Different values per
          populations
        </li>
        <li>
          <code>identical_population</code> Same value for every
          population
        </li>
        <li>
          <code>variable_time_series</code> Different values per
          time series
        </li>
        <li>
          <code>identical_time_series</code> Same value for every
          time series
        </li>
      </ol>
    <p></p>

    <p>
      Also keep in mind that values will be automatically
      expanded. For instance, if you have 52 cities with different
      unknown <code>r0</code>, just give one value and it will be
      replicated according to it's <code>partition_id</code>.
    </p>

  </div>

  <div class="span6">
    <h3>Custom groups with partitions</h3>

    <p>
      Sometimes parameter groupings have to be more precise.
      <strong>partitions</strong> allows complete control over the
      groups.  A <code>partition</code> defines a list of groups.
      Each <code>group</code> has:
      </p><ul>
        <li><code>id</code> A unique id <code>partition_id</code>that will be refered to in the value property </li>
        <li><code>times_series_id</code> or <code>population_id</code> A list of time series or populations defining the groups</li>
      </ul>
    <p></p>

  </div>

</div>


<div class="row">

  <div class="span12">

    <div class="accordion" id="link">
      <div class="accordion-group">
        <div class="accordion-heading">
          <a class="accordion-toggle" data-toggle="collapse" data-parent="#link" href="https://web.archive.org/web/20130715142756/http://plom.io/cli/grammar#simple-link">
            theta.json with custom partitions and values
          </a>
        </div>
        <div id="simple-link" class="accordion-body collapse">
          <div class="accordion-inner">

<pre class="prettyprint">{
  ...,

  "partition": {
    "data_stream": {
      "group": [
        {
          "id": "CDC",
          "time_series_id": ["all__CDC__inc", "city1__CDC__prev", "city2__CDC__inc"]
        },
        {
          "id": "google", 
          "time_series_id": ["all__google__inc"]
        }
      ],
      "comment": "split by data stream"
    }
  },

  "parameter": {
    ...,
    "phi": {
      "partition_id": "data_stream",
      "group": {
        "CDC": {
          "transformation":"log",
          "min": 0.1,
          "max": 0.1,
          "guess": 0.1,
          "sd_transf": 0.0,
          "distribution": "uniform"
        },
        "google": {
          "transformation":"log",
          "min": 0.1,
          "max": 0.1,
          "guess": 0.1,
          "sd_transf": 0.0,
          "distribution": "uniform"
        }
      }
    },
    "S": {
      "partition_id": "variable_population",

      "group": {
        "city1__all": {
          "transformation": "logit",
          "min": 0.07,
          "max": 0.07,
          "guess": 0.07,
          "sd_transf": 0.0,
          "distribution": "uniform"
        },
        "city2__all": {
          "transformation": "logit",
          "min": 0.07,
          "max": 0.07,
          "guess": 0.07,
          "sd_transf": 0.0,
          "distribution": "uniform"
        }
      }
    }
  }
}
</pre>

          </div>
        </div>
      </div>

    </div>
  </div>
</div>


<h3>Reference your priors</h3>
<div class="row">

  <div class="span6">

    <p>
      Point to the references for your priors
      using <a href="https://web.archive.org/web/20130715142756/http://www.doi.org/"> a Digital Object Identifier
        (doi)</a> and the <code>ref</code> property.
    </p>

  </div>

  <div class="span6">
<pre class="prettyprint">{
  ...
  "S": {
    "partition_id": "variable_population",
    "transformation": "logit",
    "group": {
      "city1__all": {
        "ref": ["doi", "doi"],
        "comment": "why I picked this prior / or where it comes from if no refs are available."
        "distribution": "uniform",
        "min": 0.01,
        "max": 0.07,
        },...
      },
    ...
  }, ...
}
</pre>

  </div>


</div>

<div class="page-header">
  <h1>Building the model <small>From semantic to implementation</small></h1>
</div>

<div class="row">
  <div class="span4">
    
    <h3>Wrapping up</h3>

    <p>
      We have created 4 files:
      </p><ol>
        <li>context.json</li>
        <li>process.json</li>
        <li>link.json</li>
        <li>theta.json</li>
      </ol>

      We are now ready to <strong>implement</strong> our model.
    <p></p>

  </div>

  <div class="span8">
    
    <h3>The implementation</h3>

    <p>
      In a directory containing context.json, process.json, link.json and theta.json, simply run:
    </p>

<pre class="prettyprint">plom build -t theta.json
</pre>

    <p>
      That's it, you have just <strong>coded your model in
        C</strong> using the blazing
      fast <a href="https://web.archive.org/web/20130715142756/http://www.zeromq.org/">ØMQ</a> library for your
      parallel computing needs and the rock
      stable <a href="https://web.archive.org/web/20130715142756/http://www.gnu.org/software/gsl/">GSL</a> for
      the science. It is also <strong>compiled</strong> automatically, so you are
      now ready to
      <a href="https://web.archive.org/web/20130715142756/http://plom.io/cli/methods" class="btn btn-primary">learn about the methods</a> 
    </p>

  </div>
</div>
</div>


</div> <!-- end container -->
<div id="push"></div>
</div> <!-- end wrap -->

<div id="footerGradient" class="plom-gradient"></div>
<footer>
  <div class="container">
    
    <p>© Copyright 2013 PLOM.IO. All rights reserved.</p>

    <a href="https://web.archive.org/web/20130715142756/http://plom.io/">Home</a> | <a href="https://web.archive.org/web/20130715142756/http://plom.io/about">About us</a> | <a href="https://web.archive.org/web/20130715142756/http://plom.io/weblog">Weblog</a>
  </div>
</footer>









<!--
     FILE ARCHIVED ON 14:27:56 Jul 15, 2013 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 14:33:03 Jul 22, 2014.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
</body></html>